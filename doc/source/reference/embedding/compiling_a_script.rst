.. embedding_compiling_a_script:

==================
Compiling a script
==================

You can compile a Squirrel script with the function *sq_compile*.

.. literalinclude:: compiling_a_script_code_1.h

In order to compile a script is necessary for the host application to implement a reader
function (SQLEXREADFUNC); this function is used to feed the compiler with the script
data.
The function is called every time the compiler needs a character; It has to return a
character code if succeed or 0 if the source is finished.

If sq_compile succeeds, the compiled script will be pushed as Squirrel function in the
stack.

.. :note::
    In order to execute the script, the function generated by *sq_compile()* has
    to be called through *sq_call()*

Here an example of a 'read' function that read from a file:

.. literalinclude:: compiling_a_script_code_2.h

When the compiler fails for a syntax error it will try to call the 'compiler error handler';
this function must be declared as follow:

.. literalinclude:: compiling_a_script_code_3.h

and can be set with the following API call

.. literalinclude:: compiling_a_script_code_4.h
